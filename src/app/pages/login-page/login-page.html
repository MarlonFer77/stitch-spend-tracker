<div class="login-container">
  <div class="login-form-wrapper">
    <header class="login-header">
      <img src="assets/stitch-feliz.png" alt="Stitch Mascot" class="login-mascot">
      <h2>Bem-vindo ao Stitch Expense Tracker!</h2>
      <p>Por favor, faça login para continuar.</p>
    </header>

    <form #loginFormInstance="ngForm" (ngSubmit)="onLogin(loginFormInstance)"> <mat-form-field appearance="outline" class="full-width-field">
        <mat-label>Email</mat-label> <input
          matInput
          type="email" id="username" name="username" [(ngModel)]="username" required
          email placeholder="Ex: stitch@hawaii.com"
          #usernameModel="ngModel"
        />
        <mat-error *ngIf="usernameModel.invalid && usernameModel.touched && usernameModel.errors?.['required']">
          Email é obrigatório.
        </mat-error>
        <mat-error *ngIf="usernameModel.invalid && usernameModel.touched && usernameModel.errors?.['email']">
          Por favor, insira um email válido.
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width-field">
        <mat-label>Senha</mat-label>
        <input
          matInput
          type="password"
          id="password"
          name="password"
          [(ngModel)]="password"
          required
          placeholder="Sua senha"
          #passwordModel="ngModel"
        />
        <mat-error *ngIf="passwordModel.invalid && passwordModel.touched && passwordModel.errors?.['required']">
          Senha é obrigatória.
        </mat-error>
      </mat-form-field>

      <div class="login-actions">
        <button
          mat-raised-button
          color="primary"
          type="submit"
          class="login-button"
          [disabled]="loginFormInstance.invalid || isLoading">
          <ng-container *ngIf="!isLoading; else loadingSpinner">
            Entrar
          </ng-container>
          <ng-template #loadingSpinner>
            <div class="loading-content-wrapper"> <mat-spinner [diameter]="24" color="accent" class="button-spinner"></mat-spinner>
              <span>Entrando...</span>
            </div>
          </ng-template>
        </button>
      </div>


      <div *ngIf="errorMessage && !isLoading" class="error-message server-error-message">
        {{ errorMessage }}
      </div>

      <p class="register-link">
        Não tem uma conta? <a routerLink="/register">Registre-se aqui!</a>
      </p>
    </form>
  </div>
</div>